 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\data\cron_sync_alfresco.xml ==== 
 
<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <data noupdate="1">
    <!-- Cron que lanza cada hora la sincronización de carpetas -->
    <record id="ir_cron_sync_alfresco_folders" model="ir.cron">
      <field name="name">Sync Alfresco Folders</field>
      <field name="model_id" ref="model_alfresco_folder"/>
      <field name="state">code</field>
      <field name="code">model.sync_from_alfresco()</field>
      <field name="interval_number">1</field>
      <field name="interval_type">hours</field>
      <field name="numbercall">-1</field>
      <field name="active">True</field>
      <field name="user_id" ref="base.user_root"/>  <!-- o el usuario Odoo que prefieras -->
    </record>
  </data>
</odoo>
 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\security\ir.model.access.csv ==== 
 
id,name,model_id:id,group_id:id,perm_read,perm_write,perm_create,perm_unlink
access_alfresco_report_mapping,access_alfresco_report_mapping,model_alfresco_report_mapping,,1,1,1,1
access_alfresco_folder,access_alfresco_folder,model_alfresco_folder,,1,1,1,1
access_alfresco_file,alfresco.file,model_alfresco_file,,1,1,1,1 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\views\alfresco_config_views.xml ==== 
 
<odoo>
    <record id="view_alfresco_config_form" model="ir.ui.view">
        <field name="name">alfresco.config.form</field>
        <field name="model">alfresco.config</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="server_url"/>
                        <field name="username"/>
                        <field name="password" password="True"/>
                        <field name="repo_id"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_alfresco_config" model="ir.actions.act_window">
        <field name="name">Configuración Alfresco</field>
        <field name="res_model">alfresco.config</field>
        <field name="view_mode">form</field>
    </record>

    <menuitem id="menu_alfresco_root" name="Alfresco"/>
    <menuitem id="menu_alfresco_config" name="Configuración" parent="menu_alfresco_root" action="action_alfresco_config"/>
</odoo>
 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\views\alfresco_report_mapping_views.xml ==== 
 
<odoo>

    <record id="view_report_action_form_inherit" model="ir.ui.view">
        <field name="name">ir.actions.report.form.inherit.alfresco</field>
        <field name="model">ir.actions.report</field>
        <!-- Cambiar la referencia a la vista correcta de reportes en Odoo 16 -->
        <field name="inherit_id" ref="base.act_report_xml_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='model']" position="after">
                <field name="folder_id"/>
                <field name="metadata_field_ids"
                 widget="many2many_tags"
                 options="{'no_create': True}"
                 domain="[('model', '=', model)]"
                 placeholder="Seleccionar campos de metadata"/>
            </xpath>
        </field>
    </record>
    

    <!-- Menús -->
    <menuitem id="menu_alfresco_root" name="Alfresco"/>
   
</odoo>
 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\views\alfresco_views.xml ==== 
 
<odoo>
    <record id="view_alfresco_folder_tree" model="ir.ui.view">
        <field name="name">alfresco.folder.tree</field>
        <field name="model">alfresco.folder</field>
        <field name="arch" type="xml">
            <tree string="Carpetas Alfresco" >
                <!-- Odoo detecta automáticamente parent_id y child_ids
                     gracias a _parent_name = 'parent_id' en el modelo  -->
                <field name="name"/>
                <field name="complete_path"/>
                <field name="node_id"/>
                <field name="subfolder_count"/>
           
                <!-- parent_id no es necesario mostrarlo, se usa internamente -->
                <field name="parent_id" invisible="1"/>
            </tree>
        </field>
    </record>

    <record id="view_alfresco_folder_form" model="ir.ui.view">
        <field name="name">alfresco.folder.form</field>
        <field name="model">alfresco.folder</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_open_subfolders" type="object" class="oe_stat_button" icon="fa-folder">
                        <field name="subfolder_count" widget="statinfo" string="Subcarpetas"/>
                    </button>
                   
                </header>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="node_id"/>
                        <field name="parent_id"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_alfresco_folders" model="ir.actions.act_window">
        <field name="name">Carpetas Alfresco</field>
        <field name="res_model">alfresco.folder</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_alfresco_root" name="Alfresco"/>
    <menuitem id="menu_alfresco_folders"
              name="Carpetas"
              parent="menu_alfresco_root"
              action="action_alfresco_folders"/>
</odoo> 
 
==== Archivo: C:\Users\javier\Documents\GitHub\addons_antasi\asi_alfresco_integration\views\res_config_settings_views.xml ==== 
 
<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="alfresco_res_config_settings_view" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.alfresco.integration.inherit</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="base.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('settings')]" position="inside">
                <div class="app_settings_block" string="Alfresco" data-key="asi_alfresco_integration">
                    <h2>Integración con Alfresco</h2>

                    <div class="row">
                        <!-- Columna izquierda -->
                        <div class="col-lg-6">
                            <div class="o_setting_box">
                                    <label  string="Base URL: " for="alfresco_server_url"/>
                                    <field name="alfresco_server_url"/>
                                    <p></p>
                                     <label  string="Repo ID: " for="alfresco_repo_id"/>
                                    <field name="alfresco_repo_id"/>
                               
                            </div>
                        </div>

                        <!-- Columna derecha -->
                        <div class="col-lg-6">
                            <div class="o_setting_box">
                                <div class="o_setting_right_pane">
                                    <label  string="User Name: " for="alfresco_username"/>
                                    <field name="alfresco_username"/><p></p>
                                    <label  string="Password: " for="alfresco_password"/>
                                    <field name="alfresco_password" password="True"/><p></p>
                                    <button name="action_test_alfresco_connection"
                                            type="object"
                                            string="Test connection"
                                            class="btn btn-secondary mt16"/>                                            
                                    <button name="action_sync_alfresco_users"
                                            type="object"
                                            string="Sincronizar usuarios con Alfresco"
                                            class="btn btn-secondary mt16"/>        
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </xpath>
        </field>
    </record>
</odoo>
 
