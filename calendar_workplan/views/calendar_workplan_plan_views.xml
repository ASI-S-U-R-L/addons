<odoo>
        <record id="calendar_workplan_plan_view_form" model="ir.ui.view">
                <field name="name">calendar.workplan.plan.form</field>
                <field name="model">calendar_workplan.plan</field>
                <field name="arch" type="xml">
                        <form string="Plan">
                                <field name="company_id" invisible="1" />
                                <field name="parent_id" invisible="1" />
                                <field name="active" invisible="1" />
                                
                                <header>
                                        <!-- BotÃ³n para imprimir el informe individual -->
                                <button string="Imprimir Plan Individual"
                                        type="object"
                                        name="action_print_individual_plan"
                                        class="btn-primary"
                                        attrs="{'invisible': [('scope', '!=', 'individual')]}"/>

                                <button string="Imprimir Plan Mensual"
                                        type="object"
                                        name="action_print_report"
                                        class="btn-primary"
                                        attrs="{'invisible': [('scope', '!=', 'monthly')]}"/>
                                 <button string="Imprimir Plan Anual"
                                        type="action"
                                        name="%(calendar_workplan.action_report_annual_plan)d"
                                        class="btn-primary"
                                        attrs="{'invisible': [('scope', '!=', 'annual')]}"/>       

                    
               
            
                                </header>
                                <sheet>
                                        <group>
                                            <field name="state" widget="statusbar"/>
                                        </group>
                                        <div class="oe_button_box" name="button_box">
                                                <button class="oe_stat_button" name="child_ids_view"
                                                        type="object" icon="fa-sitemap">
                                                        <field string="Child plans"
                                                                name="child_ids"
                                                                widget="statinfo" />
                                                </button>
                                                <button class="oe_stat_button"
                                                        name="meeting_ids_view"
                                                        type="object" icon="fa-sitemap">
                                                        <field string="Meetings"
                                                                name="meeting_ids"
                                                                widget="statinfo" />
                                                </button>
                                        </div>
                                        <widget name="web_ribbon" title="Archived"
                                                bg_color="bg-danger"
                                                attrs="{'invisible': [('active', '=', True)]}" />
                                        <div class="oe_title">
                                                <h1 class="d-flex flex-row">
                                                        <field name="name" placeholder="Plan's Name"
                                                                style="font-size: min(4vw, 2.6rem);"
                                                                force_save="1" />
                                                </h1>
                                        </div>
                                        <group name="generals">
                                                <group>
                                                        <field name="scope" readonly="1" />
                                                        <field name="plan_year" force_save="1"
                                                                required="1"
                                                                attrs="{'readonly': [('parent_id', '!=', False)]}" />
                                                        <field name="plan_month"
                                                                attrs="{'invisible': [('scope', '!=', 'monthly')]}" />
                                                </group>
                                                <group>
                                                        <field name="presented_by_partner_id" />
                                                        <field name="approved_by_partner_id" />
                                                        <field name="company_id"
                                                                placeholder="Company"
                                                                options="{'no_create': True}"
                                                                groups="base.group_multi_company" />
                                                        <field name="plan_tz" force_save="1" />

                                                </group>
                                        </group>
                                        <group name="work_plan_date_range">
                                                <label for="date_start" string="Work Plan Period" />
                                                <div class="o_row">
                                                        <field name="date_start" force_save="1"
                                                                readonly="1"
                                                                class="oe_inline" widget="daterange"
                                                                options="{'related_end_date': 'date_end'}" />
                                                        <i class="fa fa-long-arrow-right mx-2"
                                                                aria-label="Arrow icon"
                                                                title="Arrow" />
                                                        <field name="date_end" force_save="1"
                                                                readonly="1"
                                                                class="oe_inline" widget="daterange"
                                                                options="{'related_start_date': 'date_start'}" />
                                                </div>
                                        </group>
                                        <notebook>
                                                <page name="goals" string="Goals"
                                                        attrs="{'invisible': [('scope', '!=', 'annual')]}">
                                                        <field name="goal_ids"
                                                                widget="one2many">
                                                                <tree editable="bottom">
                                                                        <field name="name"
                                                                                string="Name" />
                                                                </tree>
                                                        </field>
                                                </page>
                                        </notebook>
                                </sheet>
                                <div class="oe_chatter">
                                        <field name="message_follower_ids" groups="base.group_user" />
                                        <field name="activity_ids" widget="mail_activity" />
                                        <field name="message_ids" />
                                </div>
                        </form>
                </field>
        </record>
        <!-- explicit list view definition -->
        <record id="calendar_workplan_plan_view_tree" model="ir.ui.view">
                <field name="name">calendar.workplan.plan.view.tree</field>
                <field name="model">calendar_workplan.plan</field>
                <field name="arch" type="xml">
                        <tree string="Plans" sample="1" decoration-muted="(not active)">
                                <field name="name" />
                                <field name="active" invisible="1" />
                                <field name="date_start" />
                                <field name="date_end" />
                                <field name="state" />
                                <field name="parent_id" />
                                <field name="inherited_meeting_ids" widget="many2many_tags" optional="hide"/>
                                <field name="company_id" groups="base.group_multi_company" />
                                <field name="company_id" invisible="1" />
                        </tree>
                </field>
        </record>

        <record id="calendar_workplan_plan_view_search" model="ir.ui.view">
                <field name="name">calendar.workplan.plan.search</field>
                <field name="model">calendar_workplan.plan</field>
                <field name="arch" type="xml">
                        <search string="Plans">
                                <field name="name" string="Plan" />
                                <separator />
                                <filter string="Archived" name="filter_inactive"
                                        domain="[('active','=',False)]" />
                                <filter string="Active" name="filter_active"
                                        domain="[('active','=',True)]" />
                                <filter string="Monthly" name="filter_monthly"
                                        domain="[('scope','=', 'monthly')]" />
                                <filter string="Annual" name="filter_annual"
                                        domain="[('scope','=','annual')]" />
                                <filter string="My Plans" name="filter_my_plans" domain="[('is_my_plan', '=', True)]"/>   
                                <filter string="Requires my approval" name="filter_my_approval" domain="[('requires_my_approval', '=', True)]"/>  
                                <separator />
                                <filter name="filter_date_start" string="Since" date="date_start"
                                        default_period="this_year" />
                                <group string="Group By">
                                        <filter string="Parent Plan" name="group_by_parent_id"
                                                context="{'group_by':'parent_id'}" />
                                        <filter string="Company" name="group_by_company"
                                                context="{'group_by':'company_id'}"
                                                groups="base.group_multi_company" />
                                        <filter string="State" name="group_by_state"
                                                context="{'group_by':'state'}" />
                                </group>
                        </search>
                </field>
        </record>

        <!-- actions opening views on models -->
        <record id="calendar_workplan_plan_action" model="ir.actions.act_window">
                <field name="name">Plans</field>
                <field name="res_model">calendar_workplan.plan</field>
                <field name="view_mode">tree,form</field>
                <field name="context">{'search_default_filter_date_start': 1,
                        'search_default_filter_my_plans': 1}</field>
        </record>

       <record id="mail_template_plan_approval_request" model="mail.template">
            <field name="name">Workplan Approval Request</field>
            <field name="model_id" ref="model_calendar_workplan_plan"/>
            <field name="subject">Approval requested for workplan ${object.name}</field>
            <field name="email_from">${object.company_id.email or ''}</field>
            <field name="email_to">${object.approved_by_partner_id.email or ''}</field>
            <field name="body_html"><![CDATA[
                <p>Dear ${object.approved_by_partner_id.name},</p>
                <p>The workplan <strong>${object.name}</strong> has been submitted for your approval.</p>
                <p>Please review it and take appropriate action.</p>
                <p>You can access the plan directly by clicking <a href="${object.get_base_url()}/web#id=${object.id}&model=calendar_workplan.plan&view_type=form">here</a>.</p>
                <p>Thank you,</p>
                <p>${object.presented_by_partner_id.name}</p>
            ]]></field>
        </record>
</odoo>
